# Κατανεμημένα Συστήματα ~ Εργαστήριο 1: ένα κατανεμημένο σύστημα μιας τράπεζας

## Τα επίπεδα από πάνω προς τα κάτω

### Επίπεδο Παρουσίασης

Το επίπεδο παρουσίασης είναι το επίπεδο με το οποίο αλληλεπιδρά ο τελικός χρήστης. Στην περίπτωσή μας μπορεί να είναι μια e-banking ιστοσελίδα ή εφαρμογή για κινητά, ή πιο συνηθισμένα ένα ATM. Εκτός από τους τελικούς χρήστες, χρειάζεται και ένα επίπεδο παρουσίασης αποκλειστικά για υπαλλήλους της τράπεζας, με περισσότερες δυνατότητες.

### Επίπεδο Επιχειρηματικής Λογικής

Το επίπεδο επιχειρηματικής λογικής (business logic) είναι υπεύθυνο για όλες τις λειτουργίες του συστήματος. Για την μέγιστη διαλειτουργικότητα και αρχιτεκτονική σαφήνεια, συνιστάται να είναι μια υπηρεσία ιστού (web service) που θα υλοποιεί ένα ή περισσότερα API, ανάλογα με τις ανάγκες των επιπέδων παρουσίασης. Αν υλοποιηθούν περισσότερα από ένα API θα μπορούσαν να βελτιστοποιηθούν περισσότερο, χρησιμοποιώντας για παράδειγμα στο API της web εφαρμογής HTTP και JSON, με τα υπόλοιπα να χρησιμοποιούν gRPC για μεγαλύτερη απόδοση. Σε κάθε περίπτωση τα διαφορετικά API θα μοιράζονται την ίδια επιχειρηματική λογική και δεδομένα.

### Επίπεδο Δεδομένων

Στο επίπεδο δεδομένων το σύστημα θα αποθηκεύει αποκλειστικά όλα τα δεδομένα που θέλει να διατηρήσει. Στην περίπτωση της τράπεζας, η καλύτερη υλοποίησή του θα ήταν μια παραδοσιακή σχεσιακή βάση δεδομένων, παρέχοντας τις απαιτούμενες ισχυρές εγγυήσεις ACID. Παρατίθεται ένα πολύ απλό ενδεικτικό σχήμα της βάσης:

``` sql
CREATE TABLE `users`
(
 `user_id` int NOT NULL AUTO_INCREMENT ,
 `name`    varchar(45) NOT NULL ,
 `surname` varchar(45) NOT NULL ,

  PRIMARY KEY (`user_id`)
);

CREATE TABLE `accounts`
(
 `amount`     decimal(15,2) NOT NULL ,
 `account_id` int NOT NULL AUTO_INCREMENT ,
 `owner`      int NOT NULL ,

  PRIMARY KEY (`account_id`, `owner`),
  KEY `fkIdx_17` (`owner`),
  CONSTRAINT `FK_15` FOREIGN KEY `fkIdx_17` (`owner`) REFERENCES `users` (`user_id`)
);
```

